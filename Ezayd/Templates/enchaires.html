{% load static %}
<section class="auctions-section" aria-label="Ench√®res actives">
  <header class="section-header">
    <!-- Search Box et Filtres -->
    <div class="search-filter-container">
      <!-- Barre de recherche principale -->
      <div class="search-box-container">
        <form method="get" action="" class="search-form" role="search">
          <div class="search-input-wrapper">
            <input 
              type="text" 
              name="search" 
              class="search-input" 
              placeholder="Rechercher dans les ench√®res..." 
              value="{{ request.GET.search }}"
              aria-label="Rechercher dans les ench√®res"
            >
            <button type="submit" class="search-btn" aria-label="Rechercher">
              <i class="fas fa-search" aria-hidden="true"></i>
            </button>
          </div>
        </form>
      </div>

      <!-- Boutons de filtres -->
      <div class="filter-buttons-container">
        <!-- Bouton Filtres -->
        <button class="filter-btn filter-btn-dark" onclick="toggleSidebar()">
          <i class="fas fa-sliders-h" aria-hidden="true"></i>
          Filtres
          <span id="filter-count" class="filter-count">0</span>
        </button>

        <!-- Bouton Trier -->
        <div class="filter-dropdown">
          <button class="filter-btn filter-btn-dark dropdown-btn" onclick="toggleDropdown('sort-dropdown')">
            <i class="fas fa-sort" aria-hidden="true"></i>
            TRIER
            <i class="fas fa-chevron-down dropdown-arrow" aria-hidden="true"></i>
          </button>
          <div id="sort-dropdown" class="dropdown-menu">
            <a href="?sort=price_asc" class="dropdown-item">Prix croissant</a>
            <a href="?sort=price_desc" class="dropdown-item">Prix d√©croissant</a>
            <a href="?sort=date_asc" class="dropdown-item">Date croissante</a>
            <a href="?sort=date_desc" class="dropdown-item">Date d√©croissante</a>
            <a href="?sort=popular" class="dropdown-item">Plus populaires</a>
          </div>
        </div>

        <!-- Bouton √âtat -->
        <div class="filter-dropdown">
          <button class="filter-btn filter-btn-dark dropdown-btn" onclick="toggleDropdown('status-dropdown')">
            <i class="fas fa-clock" aria-hidden="true"></i>
            √âTAT
            <i class="fas fa-chevron-down dropdown-arrow" aria-hidden="true"></i>
          </button>
          <div id="status-dropdown" class="dropdown-menu">
            <a href="?status=active" class="dropdown-item">üü¢ Actives</a>
            <a href="?status=upcoming" class="dropdown-item">üü° √Ä venir</a>
            <a href="?status=ending_soon" class="dropdown-item">üî¥ Se terminent bient√¥t</a>
            <a href="?status=all" class="dropdown-item">Toutes</a>
          </div>
        </div>

        <!-- Bouton Vue -->
        <div class="filter-dropdown">
          <button class="filter-btn filter-btn-dark dropdown-btn" onclick="toggleDropdown('view-dropdown')">
            <i class="fas fa-th" aria-hidden="true"></i>
            VUE
            <i class="fas fa-chevron-down dropdown-arrow" aria-hidden="true"></i>
          </button>
          <div id="view-dropdown" class="dropdown-menu">
            <a href="?view=grid" class="dropdown-item">üî≤ Grille</a>
            <a href="?view=list" class="dropdown-item">üìã Liste</a>
            <a href="?view=compact" class="dropdown-item">üì± Compact</a>
          </div>
        </div>
      </div>
    </div>

    <!-- Overlay pour fermer la sidebar -->
    <div id="sidebar-overlay" class="sidebar-overlay"></div>

    <!-- Sidebar de filtres en mode sombre -->
    <div id="sidebar" class="sidebar">
      <div class="sidebar-header">
        <h3 class="sidebar-title">
          <i class="fas fa-filter"></i>
          Filtres avanc√©s
        </h3>
        <button class="close-btn" onclick="toggleSidebar()" aria-label="Fermer les filtres">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <div class="sidebar-content">
        <div class="filter-group" data-filter="wilaya">
          <label for="wilaya">Wilaya</label>
          <select id="wilaya" name="wilaya" onchange="updateFilters()">
            <option value="" disabled selected>Choisir une Wilaya</option>
            <option value="01">Adrar</option>
            <option value="02">Chlef</option>
            <option value="03">Laghouat</option>
            <option value="04">Oum El Bouaghi</option>
            <option value="05">Batna</option>
            <option value="06">B√©ja√Øa</option>
            <option value="07">Biskra</option>
            <option value="08">B√©char</option>
            <option value="09">Blida</option>
            <option value="10">Bouira</option>
            <option value="11">Tamanrasset</option>
            <option value="12">T√©bessa</option>
            <option value="13">Tlemcen</option>
            <option value="14">Tiaret</option>
            <option value="15">Tizi Ouzou</option>
            <option value="16">Algiers</option>
            <option value="17">Djelfa</option>
            <option value="18">Jijel</option>
            <option value="19">S√©tif</option>
            <option value="20">Sa√Øda</option>
            <option value="21">Skikda</option>
            <option value="22">Sidi Bel Abb√®s</option>
            <option value="23">Annaba</option>
            <option value="24">Guelma</option>
            <option value="25">Constantine</option>
            <option value="26">M√©d√©a</option>
            <option value="27">Mostaganem</option>
            <option value="28">M'Sila</option>
            <option value="29">Mascara</option>
            <option value="30">Ouargla</option>
            <option value="31">Oran</option>
            <option value="32">El Bayadh</option>
            <option value="33">Illizi</option>
            <option value="34">Bordj Bou Arr√©ridj</option>
            <option value="35">Boumerd√®s</option>
            <option value="36">El Tarf</option>
            <option value="37">Tindouf</option>
            <option value="38">Tissemsilt</option>
            <option value="39">El Oued</option>
            <option value="40">Khenchela</option>
            <option value="41">Souk Ahras</option>
            <option value="42">Tipaza</option>
            <option value="43">Mila</option>
            <option value="44">A√Øn Defla</option>
            <option value="45">Na√¢ma</option>
            <option value="46">A√Øn T√©mouchent</option>
            <option value="47">Gharda√Øa</option>
            <option value="48">Relizane</option>
            <option value="49">Timimoun</option>
            <option value="50">Bordj Badji Mokhtar</option>
            <option value="51">Ouled Djellal</option>
            <option value="52">B√©ni Abb√®s</option>
            <option value="53">In Salah</option>
            <option value="54">In Guezzam</option>
            <option value="55">Touggourt</option>
            <option value="56">Djanet</option>
            <option value="57">El M'Ghair</option>
            <option value="58">El Menia</option>
          </select>
        </div>

        <div class="filter-group" data-filter="etat">
          <label for="etat">√âtat</label>
          <select id="etat" name="etat" onchange="updateFilters()">
            <option value="" disabled selected>Choisir un √©tat</option>
            <option value="active">Active</option>
            <option value="upcoming">√Ä venir</option>
            <option value="ended">Termin√©e</option>
          </select>
        </div>

        <div class="filter-group" data-filter="avant">
          <label for="avant">Avant</label>
          <select name="avant" id="avant" onchange="updateFilters()">
            <option value="2000">2000</option>
            <option value="2001">2001</option>
            <option value="2002">2002</option>
            <option value="2003">2003</option>
            <option value="2004">2004</option>
            <option value="2005">2005</option>
            <option value="2006">2006</option>
            <option value="2007">2007</option>
            <option value="2008">2008</option>
            <option value="2009">2009</option>
            <option value="2010">2010</option>
            <option value="2011">2011</option>
            <option value="2012">2012</option>
            <option value="2013">2013</option>
            <option value="2014">2014</option>
            <option value="2015">2015</option>
            <option value="2016">2016</option>
            <option value="2017">2017</option>
            <option value="2018">2018</option>
            <option value="2019">2019</option>
            <option value="2020">2020</option>
            <option value="2021">2021</option>
            <option value="2022">2022</option>
            <option value="2023">2023</option>
            <option value="2024">2024</option>
            <option value="2025" selected>2025</option>
          </select>
        </div>

        <div class="filter-group" data-filter="apres">
          <label for="apres">Apr√®s</label>
          <select name="apres" id="apres" onchange="updateFilters()">
            <option value="2000" selected>2000</option>
            <option value="2001">2001</option>
            <option value="2002">2002</option>
            <option value="2003">2003</option>
            <option value="2004">2004</option>
            <option value="2005">2005</option>
            <option value="2006">2006</option>
            <option value="2007">2007</option>
            <option value="2008">2008</option>
            <option value="2009">2009</option>
            <option value="2010">2010</option>
            <option value="2011">2011</option>
            <option value="2012">2012</option>
            <option value="2013">2013</option>
            <option value="2014">2014</option>
            <option value="2015">2015</option>
            <option value="2016">2016</option>
            <option value="2017">2017</option>
            <option value="2018">2018</option>
            <option value="2019">2019</option>
            <option value="2020">2020</option>
            <option value="2021">2021</option>
            <option value="2022">2022</option>
            <option value="2023">2023</option>
            <option value="2024">2024</option>
            <option value="2025">2025</option>
          </select>
        </div>

        <!-- Boutons d'action -->
        <div class="filter-actions">
          <button class="filter-action-btn secondary" onclick="clearAllFilters()">
            <i class="fas fa-eraser"></i>
            Effacer
          </button>
          <button class="filter-action-btn primary" onclick="applyFilters()">
            <i class="fas fa-check"></i>
            Appliquer
          </button>
        </div>
      </div>
    </div>
  </header>

  <div class="auction-grid" role="list">
    {% for enchere in enchaires %}
    <article
      class="auction-card {% if user in enchere.savers.all %}bookmarked{% endif %}"
      role="listitem"
    >
      <div class="card-image">
        <div class="lot-type-badge {{ enchere.lot_type|lower }}">
          {{ enchere.lot_type }}
        </div>

        {% if enchere.main_image_url %}
        <img
          src="{{ enchere.main_image_url }}"
          alt="{{ enchere.lot.nom }}"
          loading="lazy"
          width="300"
          height="200"
        />
        {% else %}
        <img
          src="/media/images/default-image.jpg"
          alt="Image par d√©faut"
          loading="lazy"
          width="300"
          height="200"
        />
        {% endif %}

        <div class="auction-title">
          <h3>{{ enchere.lot.nom }}</h3>
        </div>

        <div class="lot-type-badge {{ enchere.lot.type }}">
          {{ enchere.lot.get_type_display }}
        </div>

        <div class="card-overlay">
          <div class="time-remaining">
            <i class="fas fa-clock" aria-hidden="true"></i>
            <span>{{ enchere.date_fin|timeuntil }} restantes</span>
          </div>
        </div>

        <form method="post" action="{% url 'toggle_favori' enchere.id %}">
          {% csrf_token %}
          <button
            type="submit"
            class="bookmark-btn"
            aria-label="{% if user in enchere.savers.all %}Retirer des favoris{% else %}Ajouter aux favoris{% endif %}"
            aria-pressed="{% if user in enchere.savers.all %}true{% else %}false{% endif %}"
          >
            <i class="fas fa-bookmark {% if user in enchere.savers.all %}saved{% endif %}"></i>
          </button>
        </form>
      </div>

      <div class="card-content">
        <p class="card-description">
          {{ enchere.lot.description|truncatewords:20 }}
        </p>
      </div>
    </article>
    {% empty %}
    <p class="auction-results-empty">
      <i class="fas fa-search" aria-hidden="true"></i>
      Aucune ench√®re active disponible pour le moment.
    </p>
    {% endfor %}
  </div>
</section>

<style>
/* ===== VARIABLES CSS ===== */
:root {
  --primary-color: #ff6b35;
  --primary-gradient: linear-gradient(135deg, #ff6b35 0%, #f7931e 100%);
  --dark-bg: #1a1a1a;
  --sidebar-bg: #1e1e1e;
  --card-bg: #2d2d2d;
  --border-color: #404040;
  --text-light: #adb5bd;
  --text-muted: #6c757d;
  --white: #ffffff;
  --shadow-light: 0 3px 15px rgba(0, 0, 0, 0.1);
  --shadow-medium: 0 4px 20px rgba(0, 0, 0, 0.15);
  --shadow-heavy: 0 8px 30px rgba(0, 0, 0, 0.2);
  --input-bg: #2a2a2a;
  --input-border: #404040;
  --input-text: #e0e0e0;
  --button-bg: #333333;
  --button-hover-bg: #444444;
}

/* ===== LAYOUT PRINCIPAL ===== */
.auctions-section {
  background-color: var(--dark-bg);
  min-height: 100vh;
  padding: 16px;
  color: var(--white);
}

.search-filter-container {
  display: flex;
  flex-direction: column;
  gap: 16px;
  margin-bottom: 24px;
  width: 100%;
  max-width: 1000px;
  margin-left: auto;
  margin-right: auto;
  animation: fadeInUp 0.6s ease-out;
}

/* ===== BARRE DE RECHERCHE EN MODE SOMBRE ===== */
.search-box-container {
  width: 100%;
}

.search-form {
  width: 100%;
}

.search-input-wrapper {
  position: relative;
  width: 100%;
}

.search-input {
  width: 100%;
  padding: 12px 55px 12px 18px;
  font-size: 16px;
  border: none;
  border-radius: 40px;
  background-color: var(--input-bg); /* Mode sombre */
  color: var(--input-text); /* Texte clair pour mode sombre */
  transition: all 0.3s ease;
  outline: none;
  font-family: inherit;
  box-shadow: var(--shadow-light);
  font-weight: 500;
  border: 1px solid var(--input-border);
}

.search-input:focus {
  background-color: #333; /* Plus fonc√© en focus */
  box-shadow: var(--shadow-medium);
  transform: translateY(-1px);
  animation: searchPulse 2s ease-in-out infinite;
  border-color: var(--primary-color);
}

.search-input::placeholder {
  color: var(--text-muted);
  font-style: italic;
  font-weight: 400;
}

.search-btn {
  position: absolute;
  right: 4px;
  top: 50%;
  transform: translateY(-50%);
  background: var(--primary-gradient);
  border: none;
  border-radius: 50%;
  width: 40px;
  height: 40px;
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--white);
  font-size: 16px;
  box-shadow: 0 3px 12px rgba(255, 107, 53, 0.3);
}

.search-btn:hover {
  background: linear-gradient(135deg, #f7931e 0%, #ff6b35 100%);
  transform: translateY(-50%) scale(1.05);
  box-shadow: 0 4px 15px rgba(255, 107, 53, 0.4);
}

/* ===== BOUTONS DE FILTRES EN MODE SOMBRE ===== */
.filter-buttons-container {
  display: flex;
  align-items: center;
  gap: 12px;
  justify-content: center;
  width: 100%;
  flex-wrap: wrap;
}

.filter-btn {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 10px 16px;
  border: none;
  border-radius: 20px;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  text-transform: uppercase;
  letter-spacing: 0.3px;
  min-width: 100px;
  justify-content: center;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  position: relative;
}

.filter-btn-dark {
  background-color: var(--button-bg);
  color: var(--white);
  border: 1px solid var(--border-color);
}

.filter-btn-dark:hover {
  background-color: var(--button-hover-bg);
  border-color: var(--primary-color);
  transform: translateY(-1px);
  box-shadow: 0 3px 12px rgba(0, 0, 0, 0.2);
}

.filter-btn-light {
  background-color: var(--button-bg); /* Chang√© en mode sombre */
  color: var(--white); /* Texte blanc pour mode sombre */
  border: 1px solid var(--border-color);
}

.filter-btn-light:hover {
  background-color: var(--button-hover-bg);
  border-color: var(--primary-color);
  color: var(--primary-color);
  transform: translateY(-1px);
  box-shadow: 0 3px 12px rgba(255, 107, 53, 0.15);
}

.filter-count {
  position: absolute;
  top: -6px;
  right: -6px;
  background-color: #ff4444;
  color: var(--white);
  border-radius: 50%;
  width: 16px;
  height: 16px;
  font-size: 9px;
  display: none;
  align-items: center;
  justify-content: center;
  font-weight: bold;
}

/* ===== DROPDOWNS ===== */
.filter-dropdown {
  position: relative;
}

.dropdown-arrow {
  font-size: 10px;
  transition: transform 0.3s ease;
  margin-left: auto;
}

.filter-dropdown.open .dropdown-arrow {
  transform: rotate(180deg);
}

.dropdown-menu {
  position: absolute;
  top: calc(100% + 8px);
  left: 50%;
  transform: translateX(-50%);
  background: var(--white);
  border: 1px solid #e9ecef;
  border-radius: 12px;
  box-shadow: var(--shadow-heavy);
  z-index: 1000;
  opacity: 0;
  visibility: hidden;
  transform: translateX(-50%) translateY(-8px);
  transition: all 0.3s ease;
  min-width: 180px;
  overflow: hidden;
}

.dropdown-menu.show {
  opacity: 1;
  visibility: visible;
  transform: translateX(-50%) translateY(0);
}

.dropdown-item {
  display: block;
  padding: 12px 18px;
  color: #333;
  text-decoration: none;
  transition: all 0.2s ease;
  border-bottom: 1px solid #f8f9fa;
  font-size: 13px;
  font-weight: 500;
}

.dropdown-item:last-child {
  border-bottom: none;
}

.dropdown-item:hover {
  background-color: #fff5f2;
  color: var(--primary-color);
  padding-left: 22px;
}

/* ===== SIDEBAR AVEC CONTENU D√âCAL√â ===== */
.sidebar-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0, 0, 0, 0.7);
  z-index: 998;
  opacity: 0;
  visibility: hidden;
  transition: opacity 0.3s ease, visibility 0.3s ease;
}

.sidebar-overlay.active {
  opacity: 1;
  visibility: visible;
}

.sidebar {
  position: fixed;
  top: 0;
  left: -320px;
  width: 320px;
  height: 100vh;
  background: linear-gradient(180deg, var(--sidebar-bg) 0%, #1a1a1a 100%);
  z-index: 999;
  transition: left 0.3s ease;
  overflow-y: auto;
  box-shadow: 3px 0 20px rgba(0, 0, 0, 0.8);
  border-right: 1px solid var(--border-color);
}

.sidebar.open {
  left: 0;
}

.sidebar-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 18px;
  border-bottom: 1px solid var(--border-color);
  background-color: rgba(255, 107, 53, 0.1);
  margin-top: 50px; /* Ajout d'une marge en haut pour √©viter la navbar */
}

.sidebar-title {
  color: var(--white);
  font-size: 16px;
  font-weight: 600;
  margin: 0;
  display: flex;
  align-items: center;
  gap: 8px;
}

.sidebar-title i {
  color: var(--primary-color);
}

.close-btn {
  background: none;
  border: none;
  color: var(--text-light);
  font-size: 18px;
  cursor: pointer;
  padding: 6px;
  border-radius: 50%;
  transition: all 0.3s ease;
  width: 36px;
  height: 36px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.close-btn:hover {
  background-color: rgba(255, 107, 53, 0.1);
  color: var(--primary-color);
  transform: rotate(90deg);
}

.sidebar-content {
  padding: 18px;
}

.filter-group {
  margin-bottom: 18px;
  opacity: 0;
  transform: translateX(-20px);
  animation: slideIn 0.3s ease forwards;
}

.filter-group:nth-child(1) { animation-delay: 0.1s; }
.filter-group:nth-child(2) { animation-delay: 0.2s; }
.filter-group:nth-child(3) { animation-delay: 0.3s; }
.filter-group:nth-child(4) { animation-delay: 0.4s; }

.filter-group label {
  display: block;
  margin-bottom: 6px;
  font-weight: 600;
  font-size: 12px;
  color: var(--text-light);
  text-transform: uppercase;
  letter-spacing: 0.3px;
}

.filter-group select {
  width: 100%;
  padding: 10px 14px;
  font-size: 14px;
  background-color: #2a2a2a;
  color: var(--white);
  border: 1px solid var(--border-color);
  border-radius: 6px;
  appearance: none;
  cursor: pointer;
  background-image: url("data:image/svg+xml;utf8,<svg fill='%23adb5bd' height='24' viewBox='0 0 24 24' width='24' xmlns='http://www.w3.org/2000/svg'><path d='M7 10l5 5 5-5z'/></svg>");
  background-repeat: no-repeat;
  background-position: right 12px center;
  background-size: 14px;
  transition: all 0.3s ease;
}

.filter-group select:focus {
  outline: none;
  border-color: var(--primary-color);
  background-color: #333;
  box-shadow: 0 0 0 2px rgba(255, 107, 53, 0.1);
}

.filter-group select:hover {
  border-color: #555;
  background-color: #333;
}

.filter-group.active label {
  color: var(--primary-color);
}

.filter-group.active select {
  border-color: var(--primary-color);
  background-color: rgba(255, 107, 53, 0.1);
}

.filter-actions {
  margin-top: 24px;
  display: flex;
  gap: 10px;
}

.filter-action-btn {
  flex: 1;
  padding: 12px 16px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-size: 12px;
  font-weight: 600;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  text-transform: uppercase;
  letter-spacing: 0.3px;
}

.filter-action-btn.primary {
  background: var(--primary-gradient);
  color: var(--white);
  box-shadow: 0 3px 12px rgba(255, 107, 53, 0.3);
}

.filter-action-btn.primary:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 15px rgba(255, 107, 53, 0.4);
}

.filter-action-btn.secondary {
  background-color: #444;
  color: var(--text-light);
  border: 1px solid var(--border-color);
}

.filter-action-btn.secondary:hover {
  background-color: #555;
  color: var(--white);
  transform: translateY(-1px);
}

/* ===== CARTES D'ENCH√àRES ===== */
.auction-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 20px;
  margin-top: 24px;
}

.auction-card {
  background-color: var(--card-bg);
  border-radius: 12px;
  overflow: hidden;
  transition: all 0.3s ease;
  border: 1px solid var(--border-color);
}

.auction-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
  border-color: var(--primary-color);
}

.card-content {
  padding: 16px;
}

.card-description {
  color: var(--text-light);
  line-height: 1.6;
  margin: 0;
}

.auction-results-empty {
  text-align: center;
  color: var(--text-muted);
  font-size: 16px;
  padding: 50px 20px;
  background-color: var(--card-bg);
  border-radius: 12px;
  margin: 30px auto;
  max-width: 450px;
}

.auction-results-empty i {
  font-size: 40px;
  margin-bottom: 12px;
  display: block;
  color: #495057;
}

/* ===== ANIMATIONS ===== */
@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(20px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slideIn {
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes searchPulse {
  0% { box-shadow: var(--shadow-light); }
  50% { box-shadow: 0 4px 20px rgba(255, 107, 53, 0.1); }
  100% { box-shadow: var(--shadow-light); }
}

/* ===== SCROLLBAR PERSONNALIS√âE ===== */
.sidebar::-webkit-scrollbar {
  width: 5px;
}

.sidebar::-webkit-scrollbar-track {
  background: #2a2a2a;
}

.sidebar::-webkit-scrollbar-thumb {
  background: var(--border-color);
  border-radius: 3px;
}

.sidebar::-webkit-scrollbar-thumb:hover {
  background: #666;
}

/* ===== RESPONSIVE ===== */
@media (max-width: 768px) {
  .search-filter-container {
    gap: 12px;
    padding: 0 12px;
    margin-bottom: 20px;
  }
  
  .filter-buttons-container {
    gap: 10px;
  }
  
  .search-input {
    font-size: 16px;
    padding: 10px 50px 10px 16px;
  }
  
  .search-btn {
    width: 36px;
    height: 36px;
    font-size: 14px;
  }
  
  .filter-btn {
    padding: 8px 14px;
    font-size: 11px;
    min-width: 85px;
  }

  .sidebar {
    width: 100%;
    left: -100%;
  }
  
  .sidebar-header {
    margin-top: 40px; /* L√©g√®rement r√©duit sur mobile */
  }
}

@media (max-width: 480px) {
  .auctions-section {
    padding: 12px;
  }

  .search-input {
    padding: 8px 45px 8px 14px;
    font-size: 15px;
  }
  
  .search-btn {
    width: 32px;
    height: 32px;
    font-size: 13px;
  }
  
  .filter-btn {
    padding: 6px 12px;
    font-size: 10px;
    min-width: 75px;
  }
}
</style>

<script>
// ===== VARIABLES GLOBALES =====
let activeFilters = new Set();
let isAnimating = false;

// ===== GESTION DES DROPDOWNS =====
function toggleDropdown(dropdownId) {
  const allDropdowns = document.querySelectorAll('.dropdown-menu');
  const allDropdownContainers = document.querySelectorAll('.filter-dropdown');
  
  allDropdowns.forEach((menu, index) => {
    if (menu.id !== dropdownId) {
      menu.classList.remove('show');
      allDropdownContainers[index].classList.remove('open');
    }
  });
  
  const dropdown = document.getElementById(dropdownId);
  const container = dropdown.parentElement;
  
  dropdown.classList.toggle('show');
  container.classList.toggle('open');
}

// ===== GESTION DE LA SIDEBAR =====
function toggleSidebar() {
  if (isAnimating) return;
  isAnimating = true;

  const sidebar = document.getElementById("sidebar");
  const overlay = document.getElementById("sidebar-overlay");
  const isOpen = sidebar.classList.contains("open");

  if (isOpen) {
    closeSidebar();
  } else {
    openSidebar();
  }

  setTimeout(() => {
    isAnimating = false;
  }, 300);
}

function openSidebar() {
  const sidebar = document.getElementById("sidebar");
  const overlay = document.getElementById("sidebar-overlay");
  
  sidebar.classList.add("open");
  overlay.classList.add("active");
  document.body.style.overflow = "hidden";
}

function closeSidebar() {
  const sidebar = document.getElementById("sidebar");
  const overlay = document.getElementById("sidebar-overlay");
  
  sidebar.classList.remove("open");
  overlay.classList.remove("active");
  document.body.style.overflow = "";
}

// ===== GESTION DES FILTRES =====
function updateFilters() {
  const wilaya = document.getElementById("wilaya").value;
  const etat = document.getElementById("etat").value;
  const avant = document.getElementById("avant").value;
  const apres = document.getElementById("apres").value;

  activeFilters.clear();
  
  if (wilaya && wilaya !== "") activeFilters.add("wilaya");
  if (etat && etat !== "") activeFilters.add("etat");
  if (avant !== "2025") activeFilters.add("avant");
  if (apres !== "2000") activeFilters.add("apres");

  updateFilterDisplay();
  updateFilterCount();
}

function updateFilterDisplay() {
  const filterGroups = document.querySelectorAll('.filter-group');
  
  filterGroups.forEach(group => {
    const filterName = group.getAttribute('data-filter');
    if (activeFilters.has(filterName)) {
      group.classList.add('active');
    } else {
      group.classList.remove('active');
    }
  });
}

function updateFilterCount() {
  const countElement = document.getElementById("filter-count");
  const count = activeFilters.size;
  
  if (count > 0) {
    countElement.textContent = count;
    countElement.style.display = "flex";
  } else {
    countElement.style.display = "none";
  }
}

function clearAllFilters() {
  document.getElementById("wilaya").selectedIndex = 0;
  document.getElementById("etat").selectedIndex = 0;
  document.getElementById("avant").value = "2025";
  document.getElementById("apres").value = "2000";

  activeFilters.clear();
  updateFilterDisplay();
  updateFilterCount();

  const btn = event.target;
  const originalText = btn.innerHTML;
  btn.innerHTML = '<i class="fas fa-check"></i> Effac√©';
  btn.style.background = '#28a745';

  setTimeout(() => {
    btn.innerHTML = originalText;
    btn.style.background = '';
  }, 1500);
}

function applyFilters() {
  const filters = {
    wilaya: document.getElementById("wilaya").value,
    etat: document.getElementById("etat").value,
    avant: document.getElementById("avant").value,
    apres: document.getElementById("apres").value
  };

  console.log("Filtres appliqu√©s:", filters);

  const btn = event.target;
  const originalText = btn.innerHTML;
  btn.innerHTML = '<i class="fas fa-check"></i> Appliqu√©';

  setTimeout(() => {
    btn.innerHTML = originalText;
    closeSidebar();
  }, 1000);
}

// ===== EVENT LISTENERS =====
document.addEventListener('DOMContentLoaded', function() {
  // Fermer les dropdowns en cliquant √† l'ext√©rieur
  document.addEventListener('click', function(event) {
    if (!event.target.closest('.filter-dropdown')) {
      const allDropdowns = document.querySelectorAll('.dropdown-menu');
      const allDropdownContainers = document.querySelectorAll('.filter-dropdown');
      
      allDropdowns.forEach((menu, index) => {
        menu.classList.remove('show');
        allDropdownContainers[index].classList.remove('open');
      });
    }
  });

  // Fermer la sidebar avec l'overlay
  const overlay = document.getElementById("sidebar-overlay");
  if (overlay) {
    overlay.addEventListener("click", closeSidebar);
  }

  // Fermer avec Escape
  document.addEventListener("keydown", function(event) {
    if (event.key === "Escape") {
      const sidebar = document.getElementById("sidebar");
      if (sidebar && sidebar.classList.contains("open")) {
        closeSidebar();
      }
    }
  });

  // Animation du bouton de recherche
  const searchBtn = document.querySelector('.search-btn');
  if (searchBtn) {
    searchBtn.addEventListener('click', function(e) {
      this.style.transform = 'translateY(-50%) scale(0.9)';
      setTimeout(() => {
        this.style.transform = 'translateY(-50%) scale(1)';
      }, 150);
    });
  }

  // Validation des ann√©es
  document.getElementById("avant").addEventListener("change", function() {
    const avant = parseInt(this.value);
    const apres = parseInt(document.getElementById("apres").value);
    
    if (avant < apres) {
      document.getElementById("apres").value = this.value;
      updateFilters();
    }
  });

  document.getElementById("apres").addEventListener("change", function() {
    const avant = parseInt(document.getElementById("avant").value);
    const apres = parseInt(this.value);
    
    if (apres > avant) {
      document.getElementById("avant").value = this.value;
      updateFilters();
    }
  });

  // Initialiser les filtres
  updateFilters();
});
</script>